<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>PetMiner</title>
  <link rel="stylesheet" href="style.css" />
</head>
<body>
  <div class="container">
    <!-- Header -->
    <header>
      <h1>🐾 PetMiner</h1>
      <p>Your retro-futuristic mining game</p>
    </header>

    <!-- Tabs -->
    <nav>
      <button class="tab-button" onclick="showPage('home')">Home</button>
      <button class="tab-button" onclick="showPage('earn')">Earn</button>
      <button class="tab-button" onclick="showPage('frens')">Frens</button>
    </nav>

    <!-- Pages -->
    <section id="home" class="page">
      <h2>Welcome home, miner! 🏠</h2>
      <p>Start mining to earn MPET tokens</p>
    </section>

    <section id="earn" class="page hidden">
      <h2>⛏️ Start Mining</h2>
      <button id="mine-button">Mine</button>
      <p>Mpet: <span id="mpet">0</span></p>

      <!-- Daily Quest Card -->
      <div id="daily-quest">
        <h3>🎯 Daily Quest</h3>
        <div class="progress-container">
          <div class="progress-bar">
            <div id="quest-progress" class="progress-fill"></div>
          </div>
          <div class="progress-text">
            <span id="quest-count">0</span>/3 Mining Completed
          </div>
        </div>
        <button id="claim-btn" disabled>Claim 25 MPET</button>
        <p id="quest-complete" class="hidden">✅ Reward claimed!</p>
      </div>
    </section>

    <section id="frens" class="page hidden">
      <h2>Invite your frens 🤝</h2>
      <p>Coming soon...</p>
    </section>
  </div>

  <script>
    // Tabs
    function showPage(pageId) {
      document.querySelectorAll('.page').forEach(p => p.classList.add('hidden'));
      document.getElementById(pageId).classList.remove('hidden');
      
      // Update active tab style
      document.querySelectorAll('.tab-button').forEach(btn => {
        btn.classList.remove('active');
      });
      event.target.classList.add('active');
    }

    // Mpet system
    let mpet = 0;
    function addMpet(amount) {
      mpet += amount;
      document.getElementById("mpet").textContent = mpet;
    }

    // Daily Quest System
    const QUEST_MAX = 3;
    const REWARD_AMOUNT = 25;
    let questCompleted = false;

    function getTodayKey() {
      const today = new Date();
      return `quest-${today.getFullYear()}-${today.getMonth()}-${today.getDate()}`;
    }

    function loadQuestProgress() {
      const saved = localStorage.getItem(getTodayKey());
      return saved ? JSON.parse(saved) : { count: 0, claimed: false };
    }

    function saveQuestProgress(progress) {
      localStorage.setItem(getTodayKey(), JSON.stringify(progress));
    }

    function updateQuestUI() {
      const progress = loadQuestProgress();
      const questCount = document.getElementById("quest-count");
      const questProgress = document.getElementById("quest-progress");
      const claimBtn = document.getElementById("claim-btn");
      const completeMsg = document.getElementById("quest-complete");

      questCount.textContent = progress.count;
      questProgress.style.width = `${(progress.count / QUEST_MAX) * 100}%`;

      if (progress.count >= QUEST_MAX) {
        if (progress.claimed) {
          claimBtn.classList.add('hidden');
          completeMsg.classList.remove('hidden');
        } else {
          claimBtn.disabled = false;
        }
      } else {
        claimBtn.disabled = true;
      }
    }

    function incrementQuest() {
      const progress = loadQuestProgress();
      if (progress.count < QUEST_MAX && !progress.claimed) {
        progress.count++;
        saveQuestProgress(progress);
        updateQuestUI();
      }
    }

    function claimReward() {
      const progress = loadQuestProgress();
      if (!progress.claimed && progress.count >= QUEST_MAX) {
        progress.claimed = true;
        saveQuestProgress(progress);
        addMpet(REWARD_AMOUNT);
        updateQuestUI();
        
        // Reward animation
        const rewardPopup = document.createElement('div');
        rewardPopup.textContent = `+${REWARD_AMOUNT} MPET!`;
        rewardPopup.style.position = 'fixed';
        rewardPopup.style.top = '50%';
        rewardPopup.style.left = '50%';
        rewardPopup.style.transform = 'translate(-50%, -50%)';
        rewardPopup.style.color = 'var(--neon-pink)';
        rewardPopup.style.fontSize = '2rem';
        rewardPopup.style.fontWeight = 'bold';
        rewardPopup.style.textShadow = '0 0 10px var(--neon-blue)';
        rewardPopup.style.animation = 'floatUp 1.5s forwards';
        document.body.appendChild(rewardPopup);
        
        setTimeout(() => {
          rewardPopup.remove();
        }, 1500);
      }
    }

    // Initialize
    document.addEventListener('DOMContentLoaded', () => {
      updateQuestUI();
      
      document.getElementById('mine-button').addEventListener('click', () => {
        addMpet(5);
        incrementQuest();
      });
      
      document.getElementById('claim-btn').addEventListener('click', claimReward);
      
      // Set first tab as active
      document.querySelector('.tab-button').classList.add('active');
    });

    // Animation for reward popup
    const style = document.createElement('style');
    style.textContent = `
      @keyframes floatUp {
        0% { opacity: 1; transform: translate(-50%, -50%); }
        100% { opacity: 0; transform: translate(-50%, -150%); }
      }
    `;
    document.head.appendChild(style);
  </script>
</body>
</html>
